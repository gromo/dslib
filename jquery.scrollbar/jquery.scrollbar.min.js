(function(e,r,s){var l={mobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),webkit:s.WebKitPoint?true:false,log:function(r,l){var i=r;if(l&&typeof r!="string"){i=[];e.each(r,function(e,r){i.push('"'+e+'": '+r)});i=i.join(", ")}if(s.console&&s.console.log){s.console.log(i)}},scroll:null};var i=false;var o="px";var t=[];var n=false;var a={autoScrollSize:true,duration:200,ignoreMobile:true,scrollStep:30,showArrows:true,type:"advanced",scrollx:null,scrolly:null,onInit:null,onDestroy:null};var c=function(r,s){if(!l.scroll){l.scroll=f();l.log("Custom Scrollbar v1.2")}this.container=r;this.options=e.extend({},a);this.scrollx={};this.scrolly={};if(!(l.mobile&&this.options.ignoreMobile)){var i=this;setTimeout(function(){i.init(s)},10)}};c.prototype={destroy:function(){if(!this.wrapper){return}var s=this.container.scrollLeft();var l=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:""}).removeClass("scroll-content").removeClass("scroll-scrollx_show").removeClass("scroll-scrolly_show").off(".scrollbar").scrollLeft(s).scrollTop(l);this.scrollx.scrollbar.hide().find("div").andSelf().off(".scrollbar");this.scrolly.scrollbar.hide().find("div").andSelf().off(".scrollbar");this.wrapper.remove();e(r).add("body").off(".scrollbar");if(e.isFunction(this.options.onDestroy))this.options.onDestroy.apply(this,[this.container]);if(n){w(this.resizeListener)}},getScrollbar:function(r){var s=this.options["scroll"+r];var l={advanced:'<div class="scroll-arrow scroll-arrow_less"></div>'+'<div class="scroll-arrow scroll-arrow_more"></div>'+'<div class="scroll-element_outer">'+'    <div class="scroll-element_size"></div>'+'    <div class="scroll-element_inner-wrapper">'+'        <div class="scroll-element_inner">'+'            <div class="scroll-element_inner-bottom"></div>'+"        </div>"+"    </div>"+'    <div class="scroll-bar">'+'        <div class="scroll-bar_body">'+'            <div class="scroll-bar_body-inner"></div>'+"        </div>"+'        <div class="scroll-bar_bottom"></div>'+'        <div class="scroll-bar_center"></div>'+"    </div>"+"</div>",simple:'<div class="scroll-element_outer">'+'    <div class="scroll-element_size"></div>'+'    <div class="scroll-element_inner"></div>'+'    <div class="scroll-bar">'+"    </div>"+"</div>"};var i=l[this.options.type]?this.options.type:"advanced";if(s){if(typeof s=="string"){s=e(s).appendTo(this.wrapper)}else{s=e(s)}}else{s=e("<div>").addClass("scroll-element").html(l[i]).appendTo(this.wrapper)}if(this.options.showArrows){s.addClass("scroll-element_show-arrows")}return s.addClass("scroll-"+r)},init:function(s){var i=this;var t=this.container;var a=e.extend(this.options,s);var c={x:this.scrollx,y:this.scrolly};var f=this.wrapper;var d={scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop()};if(!f){this.wrapper=f=t.wrap(e("<div>").css({position:t.css("position")=="absolute"?"absolute":"relative"}).addClass("scroll-wrapper").addClass(t.attr("class"))).parent();this.resizeListener=t.wrapInner(e('<div class="resize-listener"></div>')).children();t.addClass("scroll-content").css({height:"auto","margin-bottom":l.scroll.height*-1+o,"margin-right":l.scroll.width*-1+o}).on("scroll.scrollbar",function(){c.x.isVisible&&c.x.scroller.css("left",t.scrollLeft()*c.x.kx+o);c.y.isVisible&&c.y.scroller.css("top",t.scrollTop()*c.y.kx+o)})}else{t.css({height:"auto"})}e.each(c,function(s,l){var o=null;var n=s=="x"?"scrollLeft":"scrollTop";var c=a.scrollStep;var f=function(){var e=t[n]();t[n](e+c);if(t[n]()==e&&o){o()}};if(!l.scrollbar){l.scrollbar=i.getScrollbar(s);l.scroller=l.scrollbar.find(".scroll-bar");var d=function(e){var r=e.originalEvent.wheelDelta||e.originalEvent.detail*-20;t[n](t[n]()-r).scroll();e.preventDefault()};if(s=="y")l.scrollbar.on({"DOMMouseScroll.scrollbar":d,"mousewheel.scrollbar":d});l.scrollbar.find(".scroll-arrow, .scroll-element_inner").on("mousedown.scrollbar",function(r){var i=true;if(e(this).hasClass("scroll-arrow")){i=e(this).hasClass("scroll-arrow_more");c=i?a.scrollStep:a.scrollStep*-1}else{i=r[s=="x"?"pageX":"pageY"]>l.scroller.offset()[s=="x"?"left":"top"];c=i?l.visible:l.visible*-1}var d=0,p=0;o=function(){clearInterval(p);clearTimeout(d);d=0;p=0};d=setTimeout(function(){p=setInterval(f,40)},a.duration+100);var h={};h[n]=t[n]()+c;t.animate(h,a.duration);return v(o,r)});l.scroller.on("mousedown.scrollbar",function(i){var o=i[s=="x"?"pageX":"pageY"];var a=t[n]();l.scrollbar.addClass("scroll-draggable");e(r).on("mousemove.scrollbar",function(e){var r=parseInt((e[s=="x"?"pageX":"pageY"]-o)/l.kx,10);t[n](a+r)});return v(function(){l.scrollbar.removeClass("scroll-draggable")},i)})}});e.each(c,function(e,r){var s="scroll-scroll"+e+"_show";var l=e=="x"?c.y:c.x;r.scrollbar.hide();l.scrollbar.removeClass(s);t.removeClass(s)});e.each(c,function(r,s){e.extend(s,r=="x"?{offset:parseInt(t.css("left"),10)||0,size:t.prop("scrollWidth"),visible:f.width()}:{offset:parseInt(t.css("top"),10)||0,size:t.prop("scrollHeight"),visible:f.height()})});function p(r,s){var i="scroll-scroll"+r+"_show";var n=r=="x"?c.y:c.x;var a=parseInt(t.css(r=="x"?"left":"top"),10)||0;var v=s.size;var d=s.visible+a;s.isVisible=v>d;if(s.isVisible){s.scrollbar.show();n.scrollbar.addClass(i);t.addClass(i)}else{s.scrollbar.hide();n.scrollbar.removeClass(i);t.removeClass(i)}if(r=="y"){t.css("height",s.isVisible?d+l.scroll.height+o:"auto")}if(c.x.size!=t.prop("scrollWidth")||c.y.size!=t.prop("scrollHeight")||c.x.visible!=f.width()||c.y.visible!=f.height()||c.x.offset!=(parseInt(t.css("left"),10)||0)||c.y.offset!=(parseInt(t.css("top"),10)||0)){e.each(c,function(r,s){e.extend(s,r=="x"?{offset:parseInt(t.css("left"),10)||0,size:t.prop("scrollWidth"),visible:f.width()}:{offset:parseInt(t.css("top"),10)||0,size:t.prop("scrollHeight"),visible:f.height()})});p(r=="x"?"y":"x",n)}}e.each(c,p);e.each(c,function(e,r){var s=e=="x"?"left":"top";var l=e=="x"?"width":"height";var i=parseInt(t.css(s),10)||0;var n=r.size;var c=r.visible+i;r.scrollbar.css(l,r.visible+o);var f=r.scrollbar.find(".scroll-element_size");f=f[l]()+parseInt(f.css(s)||0,10);if(a.autoScrollSize){r.scrollbarSize=parseInt(f*c/n,10);r.scroller.css(l,r.scrollbarSize+o)}r.scrollbarSize=parseInt(r.scroller.css(l),10);r.kx=(f-r.scrollbarSize)/(n-c)||1});if(e.isFunction(a.onInit))a.onInit.apply(this,[t]);if(n){b(this.resizeListener,function(){m(i)})}t.scrollLeft(d.scrollLeft).scrollTop(d.scrollTop).trigger("scroll")}};e.fn.scrollbar=function(r,s){var l=this;if(r=="get")l=null;this.each(function(){var i=e(this);if(i.hasClass("scroll-wrapper")||i.get(0).nodeName=="body"){return}var o=i.data("scrollbar");if(o){if(r==="get"){l=o;return false}r=typeof r=="string"&&o[r]?r:"init";o[r].apply(o,e.isArray(s)?s:[]);if(r=="destroy"){i.removeData("scrollbar");while(e.inArray(o,t)>=0)t.splice(e.inArray(o,t),1)}}else{if(typeof r!="string"){o=new c(i,r);i.data("scrollbar",o);t.push(o)}}});return l};function f(){var r={border:"none",height:"100px",margin:"0",padding:"0",width:"100px"};var s=e("<div>").css(e.extend({},r));var i=e("<div>").css(e.extend({background:"#F00",left:"-200px",overflow:"scroll",position:"absolute",top:"-200px"},r)).append(s).appendTo("body").scrollLeft(s.width()).scrollTop(s.height());var o={height:i.offset().top-s.offset().top||0,width:i.offset().left-s.offset().left||0};if(l.webkit){o.height=0;o.width=0}i.remove();return o}function v(s,l){e(r).on({"blur.scrollbar":function(){e(r).add("body").off(".scrollbar");s()},"dragstart.scrollbar":function(e){e.preventDefault();return false},"mouseup.scrollbar":function(){e(r).add("body").off(".scrollbar");s()}});e("body").on({"selectstart.scrollbar":function(e){e.preventDefault();return false}});l&&l.preventDefault();return false}function d(e,r,s){var l=r=="over";e.addEventListener("OverflowEvent"in window?"overflowchanged":r+"flow",function(e){if(e.type==r+"flow"||e.orient==0&&e.horizontalOverflow==l||e.orient==1&&e.verticalOverflow==l||e.orient==2&&e.horizontalOverflow==l&&e.verticalOverflow==l){e.flow=r;return s.call(this,e)}},false)}function p(e,r,s,l){l=l||{};var i=document.createEvent("Event");i.initEvent(r,"bubbles"in l?l.bubbles:true,"cancelable"in l?l.cancelable:true);for(var o in s)i[o]=s[o];e.dispatchEvent(i)}function h(e,r){var s="onresize"in e;if(!s&&!e._resizeSensor){var l=e._resizeSensor=document.createElement("div");l.className="resize-sensor";l.innerHTML='<div class="resize-overflow"><div></div></div><div class="resize-underflow"><div></div></div>';var i=0,o=0,t=l.firstElementChild.firstChild,n=l.lastElementChild.firstChild,a=function(r){var s=false,l=e.offsetWidth;if(i!=l){t.style.width=l-1+"px";n.style.width=l+1+"px";s=true;i=l}var a=e.offsetHeight;if(o!=a){t.style.height=a-1+"px";n.style.height=a+1+"px";s=true;o=a}if(s&&r.currentTarget!=e)p(e,"resize")};if(getComputedStyle(e).position=="static"){e.style.position="relative";e._resizeSensor._resetPosition=true}d(l,"over",a);d(l,"under",a);d(l.firstElementChild,"over",a);d(l.lastElementChild,"under",a);e.appendChild(l);a({})}var c=e._flowEvents||(e._flowEvents=[]);if(c.indexOf(r)==-1)c.push(r);if(!s)e.addEventListener("resize",r,false);e.onresize=function(r){c.forEach(function(s){s.call(e,r)})}}function u(e,r){var s=e._flowEvents.indexOf(r);if(s>-1)e._flowEvents.splice(s,1);if(!e._flowEvents.length){var l=e._resizeSensor;if(l){e.removeChild(l);if(l._resetPosition)e.style.position="static";delete e._resizeSensor}if("onresize"in e)e.onresize=null;delete e._flowEvents}e.removeEventListener("resize",r)}function b(e,r){e.data("resizeListener",r);h(e[0],r)}function w(e){var r=e.data("resizeListener");if(!r)return;h(e[0],r)}var g=function(e,r,s){s.init();if(i){l.log({scrollHeight:e.prop("scrollHeight")+":"+s.scrolly.size,scrollWidth:e.prop("scrollWidth")+":"+s.scrollx.size,visibleHeight:r.height()+":"+s.scrolly.visible,visibleWidth:r.width()+":"+s.scrollx.visible},true);if(y++>100){l.log("Scroll udpates exceed 100");clearInterval(x)}}};function m(e){g(e.container,e.wrapper,e)}var y=0;var x=setInterval(function(){var e,r,s,l,i,o;for(e=0;e<t.length;e++){s=t[e];r=s.container;l=s.wrapper;i=s.scrollx;o=s.scrolly;if(l.is(":visible")&&(r.prop("scrollWidth")!=i.size||r.prop("scrollHeight")!=o.size||l.width()!=i.visible||l.height()!=o.visible)){g(r,l,s)}}},300);window.ert=b;e(function(){var r=e("<div>test</div>").css({position:"relative",top:-9999,left:-9999}),s=e('<div class="overflow-event-test">test</div>'),l=0;e(document.body).append(r);s.appendTo(r);b(s,function(){l++});setTimeout(function(){s.css({width:25,height:250});setTimeout(function(){if(l!==0){n=true;clearInterval(x)}u(s[0]);r.remove()},0)}.bind(this),0)})})(jQuery,document,window);